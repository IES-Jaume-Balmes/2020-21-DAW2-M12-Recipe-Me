<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/moon.css" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" />
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <!--###### PRIMERA COLUMNA ######-->
        <section id="Full-Stack">
          <section
            data-markdown
            data-background-image="https://source.unsplash.com/collection/1353633/1"
            data-background-opacity="0.6"
            data-background-color="white"
          >
            <textarea data-template>
                ## Recipe-me!
                # Aqui debería ir un elemento que ayude a empezar a explicar
                ---
                ## 
                **¿Qué problema resuelve Recipe-me?**
                
                #### Recipe-me nos ayuda a crear una lista de la compra  eligiendo recetas y planificando que queremos comer durante la semana. 
                ---
                ## Frameworks
                <img align="left" height="200" src="http://www.chipsypc.com/wp-content/uploads/2010/10/symfony_black_03.png">
                <img align="right" height="200" src="https://wpintegrate.com/wp-content/uploads/2017/07/react-logo.png">
                ---
                ## Herramientas
                <img style="margin:1em" height="125" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Npm-logo.svg/800px-Npm-logo.svg.png">
                <img style="margin:1em" height="125" src="https://upload.wikimedia.org/wikipedia/commons/2/26/Logo-composer-transparent.png">
                <img style="margin:1em" height="125" src="https://1000marcas.net/wp-content/uploads/2020/02/Docker-Logo.png">
                <img style="margin:1em" height="125" src="https://rangav.gallerycdn.vsassets.io/extensions/rangav/vscode-thunder-client/1.3.0/1621339770343/Microsoft.VisualStudio.Services.Icons.Default">
                <img style="margin:1em" height="125" src="https://camo.githubusercontent.com/4bd8cf443b54bfbf9c593b1ab05ba01e3304e82ab093d87666cb2a68ee98d8cb/68747470733a2f2f6170692d706c6174666f726d2e636f6d2f6c6f676f2d323530783235302e706e67">
                <img style="margin:1em" height="125" src="https://user-images.githubusercontent.com/674621/71187801-14e60a80-2280-11ea-94c9-e56576f76baf.png"> 
                <img style="margin:1em" height="125" src="https://image.flaticon.com/icons/png/512/25/25231.png">  
                      
                ---
                ## Arquitectura
                <div class="r-stack">
                  <img  src="../../docs-src/static/Arquitectura.jpeg" >
                  <img class="fragment" src="../../docs-src/static/Arquitectura2.png" >
                </div>
                ---
                ## Database
                <img class="r-stretch" src="../../docs-src/static/BBDDfinal.png"/>
                ---
                ## Login
                <div class="r-stack r-stretch">
                  <img src="../../docs-src/static/login.png" >
                  <img class="fragment" src="https://rosolutions.com.mx/blog/wp-content/uploads/2018/11/1_g15QJL_ONdBGAdjgnld3pg.png" >
                </div>
            </textarea>
          </section>
        </section>

        <!--###### SEGUNDA COLUMNA ######-->
        <section id="Backend">
          <section
            data-markdown
            data-background-image="./static/api-platform.png"
            data-background-color="#30C1C2"
            data-background-size="contain"
          >
            <textarea data-template>
              ## Backend
              [`Symfony require api`](https://api-platform.com/)
              </textarea
            >
          </section>
          <section
            data-markdown
            data-background-image="https://source.unsplash.com/collection/1353633/2"
            data-background-opacity="0.4"
            data-background-color="white"
          >
            <textarea data-template>
                ## Data access
                ```php
                /**
                * @ApiResource(
                *     normalizationContext={"groups"={"user:read"}},
                *     denormalizationContext={"groups"={"user:write"}},
                *     collectionOperations={
                *         "get"={"security"="is_granted('ROLE_ADMIN')"},
                *         "post"
                *     },
                *     itemOperations={
                *         "get"={"security"="is_granted('ROLE_USER')"},
                *         "delete"={"security"="is_granted('ROLE_USER') and object == user"}
                *     }
                * )
                * @UniqueEntity(fields={"email"})
                * @ORM\Entity(repositoryClass=UserRepository::class)
                */
                ```
                ---
                ## Autenticación y autorización
                - Json Web Token
                [Interceptores Axios](#/2/3).
                - PHPSESSID
                
              </textarea
            >
          </section>
        </section>

        <!--###### TERCERA COLUMNA ######-->
        <section id="Frontend">
          <section
            data-markdown
            data-background-image="https://source.unsplash.com/collection/1353633/3"
            data-background-opacity="0.6"
            data-background-color="white"
          >
            <textarea data-template>
              ## Frontend
              # Aqui debería ir un elemento que ayude a empezar a explicar
              ---
              ## Material utilizado 
              - Material-UI
              - Router
              - Cookie from Universal-cookie
              ---
              ## Enrutamiento de la aplicación
              ```js
              export default function Routes() {
                const classes = useStyles();
                if (!cookie.get("token")) {
                  return (
                    <Router>
                      <Switch>
                        <Route path="/login" component={SignInSide} />
                        <Route path="/register" component={SignUpSide} />
                        <Route component={SignInSide} />
                      </Switch>
                    </Router>
                  );
                }
              
                return (
                  <Router>
                    <div className={classes.root}>
                      <Route path="/" component={Drawer} />
                      <main className={classes.content}>
                        <div className={classes.toolbar} />
                        <Switch>
                          <Route path="/" exact component={Recetas} />
                          <Route path="/recetas" component={CrearReceta} />
                          <Route path="/listas" component={Listas} />
                          <Route path="/perfil" component={Perfil} />
                        </Switch>
                      </main>
                    </div>
                  </Router>
                );
              }
              ```
              ---
              ## Interceptores Axios
              [Json web Token](#/1/2).
              ```
              axiosIntercepted.interceptors.response.use(
              (response) => {
                return response;
              },
              (error) => {
                return new Promise((resolve) => {
                  const originalRequest = error.config;

                  const refreshToken = cookie.get("refresh_token");
                  if (
                    error.response &&
                    error.response.status === 401 &&
                    error.config &&
                    !error.config.__isRetryRequest &&
                    refreshToken
                  ) {
                    originalRequest._retry = true;

                    const response = fetch(refreshUrl, {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify({
                        refresh_token: refreshToken,
                      }),
                    })
                      .then((res) => res.json())
                      .then((res) => {
                        console.log(res);
                        cookie.set("token", res.token, { path: "/" });
                        cookie.set("refresh_token", res.refresh_token, {
                          path: "/",
                        });
                        // console.log(originalRequest.url);
                        return axiosIntercepted.get(originalRequest.url, {
                          headers: {
                            Authorization: "Bearer " + res.token,
                          },
                        });
                      });
                    //TODO: Catch para el caso del refresco expirado -> Logout
                    resolve(response);
                  }

                  return Promise.reject(error);
                });
              }
            );
              ```
            </textarea>
          </section>
        </section>

        <!--###### CUARTA COLUMNA ######-->
        <section id="CasosUso">
          <section
            data-markdown
            data-background-image="https://source.unsplash.com/collection/1353633/9"
            data-background-opacity="0.4"
            data-background-color="white"
          >
            <textarea data-template>
              ## Casos de uso
              # Aqui debería ir un elemento que ayude a empezar a explicar
              ---
              ### Eliminar Ingrediente de la lista de la compra
              <div class="r-fit-text">
              Esta función se encuentra en el componente TarjetaListaActual el cual recibe información del componente padre (Listas.js)
              </div>
              <pre data-id="code-animation" >
                <code class="hljs" data-trim data-line-numbers>
                Listas.js
                actualizarLista = (id) => {
                  const newList = this.state.arrayIngredientes.filter((item) => {
                    return item.id !== id;
                  });
                  this.setState({ arrayIngredientes: newList });
                };

                TarjetaListaActual.js 
                const actualizar = props.actualizar;
                const handleRemove = (id) => {
                  actualizar(id);
                };
                <IconButton edge="end" aria-label="comments" onClick={() => {
                    handleRemove(value.id);
                }}>
                </code>
              </pre>      
              ---
              ## Guardar Lista
              ### Botón que hace llamada
              <pre data-id="code-animation" >
                <code class="hljs" data-trim data-line-numbers>
                guardarListaCompra = async () => {
                  var tokenDecoded = jwt_decode(token);
                  let arraySoloId = this.state.arrayIngredientes.map((i) => i.id);
                  let jsonPeticion = {
                    propietario: "api/users/" + tokenDecoded.userId,
                    name: this.state.nombreLista,
                    ingredients: arraySoloId,
                  };
                }
                </code>
              </pre>
            </textarea>
          </section>
        </section>

        <!--###### QUINTA COLUMNA ######-->
        <section id="Cierre">
          <section
            data-markdown
            data-background-image="https://images.unsplash.com/photo-1533073526757-2c8ca1df9f1c?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80"
            data-background-opacity="0.6"
            data-background-color="white"
          >
            <textarea data-template>
              ## Behind the musgo
              ---
              ## Ideas para el futuro
              <div class="r-fit-text">
                <ul>
                  <li>Las listas se ordenarán por likes (los usuarios podrán hacer like a las recetas).</li>
                  <li>Las recetas tendrán propietario y estos las podrán editar y eliminar.</li>
                  <li>En la lista podrás tachar lo que has añadido a tu compra para hacer una versión 
                  mas realista del post it. </li>
                  <li>El usuario podrá subir su propia foto de perfil editar su información.</li>
                  <li>Las recetas tendrán foto propia y podremos ver la persona que la creó.</li>
                  <li>Crear comunidad de Recipe-Users.</li>
                  <li>Subir aplicación a servidor</li>
                </ul>
              </div>
              ---
              ## Reflexión y conclusiones

              - Aventurarnos a utilizar estos dos frameworks(React y Symfony) los cuales no tenemos mucha experiencia no ha sido tarea fácil. La experiencia ha sido muy positiva, son muy potentes y ayudan mucho al desarrollador a desempeñar su función.
              ---
              ## Gracias Recipers!
            </textarea>
          </section>
        </section>
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      })
    </script>
  </body>
</html>
